"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[14],{4318:function(e,t,r){r.d(t,{Fh:function(){return c},bu:function(){return s},Gw:function(){return o},aU:function(){return i},Z1:function(){return n},u3:function(){return d},wt:function(){return l}}),r(6624);var a=r(7014);let n=async()=>{},o=async()=>(await fetch((0,a.l9)("/settings"))).json(),l=async(e,t)=>{await fetch((0,a.l9)("/settings/".concat(e)),{method:"POST",body:JSON.stringify(t)})},i=async()=>(await fetch((0,a.l9)("/object_info"))).json(),s=async e=>{await fetch((0,a.l9)("/queue"),{method:"POST",body:JSON.stringify({delete:[e]})})},d=async e=>{let t=await fetch((0,a.l9)("/prompt"),{method:"POST",body:JSON.stringify(e)});return{error:200!==t.status?await t.text():void 0}},u=e=>{let t=e.map(t=>{if("*"===t.sourceHandle){let r=e.find(e=>e.target===t.source);return{...t,source:r.source,sourceHandle:r.sourceHandle}}return t});return t.find(e=>"*"===e.sourceHandle)?u(t):t.filter(e=>"*"!==e.targetHandle)},c=e=>{let{graph:t,widgets:r,customWidgets:n,clientId:o}=e,l={},i={};Object.entries(t.data).forEach(e=>{let[t,o]=e;if(n.includes(o.value.widget))return;let s={...o.value.fields};Object.entries(s).forEach(e=>{let[t,n]=e,l=r[o.value.widget].input.required[t];a.lj.isInt(l)&&l[1].randomizable&&-1===n&&(s[t]=Math.trunc(Math.random()*Number.MAX_SAFE_INTEGER))}),i[t]={position:o.position,value:{...o.value,fields:s}},l[t]={class_type:o.value.widget,inputs:s}});let s=u(t.connections);return s.forEach(e=>{let a=t.data[e.source];if(!a)return;let n=r[a.value.widget].output.findIndex(t=>t===e.sourceHandle);l[e.target]&&(l[e.target].inputs[e.targetHandle]=[e.source,n])}),{prompt:l,client_id:o,extra_data:{extra_pnginfo:{workflow:{connections:s,data:i}}}}}},6624:function(e,t){t.Z={host:"127.0.0.1:8188",protocol:"http:"}},9326:function(e,t){t.Z={data:{"687e2c5c-cd33-49ae-b1a6-289cf1fdd0ff":{value:{widget:"PreviewImage",fields:{}},position:{x:1566.6656859977622,y:1241.962884856701},width:296,height:142},"d6488046-7e3d-45ce-b0cb-fc461ded790d":{value:{widget:"VAELoader",fields:{vae_name:"vae-ft-mse-840000-ema-pruned.safetensors"}},position:{x:789.4195199284518,y:1662.4628083814446},width:319,height:120},"2d69027b-18cb-4fba-a6f7-3cc6191da27a":{value:{widget:"EmptyLatentImage",fields:{width:512,height:512,batch_size:1}},position:{x:450.1747371550397,y:1618.5429203591423},width:240,height:246},"df10802c-dcb3-45cb-b61a-ed21c9435e54":{value:{widget:"VAEDecode",fields:{}},position:{x:1193.2869359712133,y:1125.515155272075},width:240,height:96},"3ab52db7-7835-409b-9742-cdbb84283789":{value:{widget:"KSampler",fields:{seed:13316703440321622e3,steps:24,cfg:8,sampler_name:"dpm_2",scheduler:"normal",denoise:.99}},position:{x:852.5481575303295,y:1036.0737133524628},width:240,height:461},"03e009af-40ce-40f8-8678-ee811fe31f41":{value:{widget:"CLIPTextEncode",fields:{text:"text, watermark"},modify:{nickname:"Negative"}},position:{x:364.94750305419154,y:1238.9188592484923},width:280,height:228},"18d73b78-7fd7-4411-a39e-b8a17e677892":{value:{widget:"CLIPTextEncode",fields:{text:"beautiful nature scenery glass bottle landscape, , purple galaxy bottle,"},modify:{nickname:"Positive"}},position:{x:365.1056570095522,y:829.0623046524952},width:278,height:154},"1ab1ba4a-5dfb-4ced-bc06-2b55af930969":{value:{widget:"CheckpointLoaderSimple",fields:{ckpt_name:"Aniverse.safetensors"}},position:{x:-269.3325424523291,y:1036.3999742057622},width:317,height:148}},connections:[{source:"1ab1ba4a-5dfb-4ced-bc06-2b55af930969",sourceHandle:"MODEL",target:"3ab52db7-7835-409b-9742-cdbb84283789",targetHandle:"model"},{source:"1ab1ba4a-5dfb-4ced-bc06-2b55af930969",sourceHandle:"CLIP",target:"18d73b78-7fd7-4411-a39e-b8a17e677892",targetHandle:"clip"},{source:"1ab1ba4a-5dfb-4ced-bc06-2b55af930969",sourceHandle:"CLIP",target:"03e009af-40ce-40f8-8678-ee811fe31f41",targetHandle:"clip"},{source:"03e009af-40ce-40f8-8678-ee811fe31f41",sourceHandle:"CONDITIONING",target:"3ab52db7-7835-409b-9742-cdbb84283789",targetHandle:"negative"},{source:"18d73b78-7fd7-4411-a39e-b8a17e677892",sourceHandle:"CONDITIONING",target:"3ab52db7-7835-409b-9742-cdbb84283789",targetHandle:"positive"},{source:"2d69027b-18cb-4fba-a6f7-3cc6191da27a",sourceHandle:"LATENT",target:"3ab52db7-7835-409b-9742-cdbb84283789",targetHandle:"latent_image"},{source:"3ab52db7-7835-409b-9742-cdbb84283789",sourceHandle:"LATENT",target:"df10802c-dcb3-45cb-b61a-ed21c9435e54",targetHandle:"samples"},{source:"d6488046-7e3d-45ce-b0cb-fc461ded790d",sourceHandle:"VAE",target:"df10802c-dcb3-45cb-b61a-ed21c9435e54",targetHandle:"vae"},{source:"df10802c-dcb3-45cb-b61a-ed21c9435e54",sourceHandle:"IMAGE",target:"687e2c5c-cd33-49ae-b1a6-289cf1fdd0ff",targetHandle:"images"}]}},36:function(e,t,r){r.d(t,{Uh:function(){return n},oy:function(){return o}});var a=r(7437);let n={"":"",cyan:"#233",cyanbg:"#355",cyangroup:"#8AA",purple:"#323",purplebg:"#535",purplegroup:"#a1309b",yellow:"#432",yellowbg:"#653",yellowgroup:"#b58b2a",black:"#222",blackbg:"#000",blackgroup:"#444",mw_red:"#962123",mw_redbg:"#B71C1C",mw_redgroup:"#FF595C",mw_pink:"#792243",mw_pinkbg:"#880E4F",mw_pinkgroup:"#FF5984",mw_purple:"#42137E",mw_purplebg:"#4A148C",mw_purplegroup:"#FF5EAF",mw_deep_purple:"#291983",mw_deep_purplebg:"#311B92",mw_deep_purplegroup:"#FF63BE",mw_indigo:"#132270",mw_indigobg:"#1A237E",indigogroup:"#FF68D3",mw_blue:"#063B94",mw_bluebg:"#0D47A1",mw_bluegroup:"#FF6EFF",mw_light_blue:"#004B8E",mw_light_bluebg:"#01579B",mw_light_bluegroup:"#FF7AFF",mw_cyan:"#005658",mw_cyanbg:"#006064",mw_cyangroup:"#00FF9E",mw_teal:"#004333",mw_tealbg:"#004D40",mw_tealgroup:"#00FFB9",mw_green:"#145013",mw_greenbg:"#1B5E20",mw_greengroup:"#FF6F5C",mw_light_green:"#2C5F11",mw_lightgreenbg:"#33691E",mw_lightgreengroup:"#FF8259",mw_lime:"#766B0A",mw_limebg:"#827717",mw_limegroup:"#FFD14B",mw_yellow:"#EE740A",mw_yellowbg:"#F57F17",mw_yellowgroup:"#FFFF4B",mw_amber:"#F96200",mw_amberbg:"#FF6F00",mw_ambergroup:"#FFA334",mw_orange:"#D94700",mw_orangebg:"#E65100",mw_orangegroup:"#FF7234",mw_deep_orange:"#B52C00",mw_deep_orangebg:"#BF360C",mw_deep_orangegroup:"#FF5733",mw_brown:"#371D1A",mw_brownbg:"#3E2723",mw_browngroup:"#A1807B",mw_gray:"#1A1717",mw_graybg:"#212121",mw_graygroup:"#848282",mw_blue_gray:"#1F2F30",mw_blue_graybg:"#263238",mw_blue_graygroup:"#6F9FA0"},o=["","cyan","cyanbg","cyangroup","purple","purplebg","purplegroup","yellow","yellowbg","yellowgroup","black","blackbg","blackgroup","mw_red","mw_redbg","mw_redgroup","mw_pink","mw_pinkbg","mw_pinkgroup","mw_purple","mw_purplebg","mw_purplegroup","mw_deep_purple","mw_deep_purplebg","mw_deep_purple","mw_indigo","mw_indigobg","indigogroup","mw_blue","mw_bluebg","mw_bluegroup","mw_light_blue","mw_light_bluebg","mw_light_bluegroup","mw_cyan","mw_cyanbg","mw_cyangroup","mw_teal","mw_tealbg","mw_tealgroup","mw_green","mw_greenbg","mw_greengroup","mw_light_green","mw_lightgreenbg","mw_lightgreengroup","mw_lime","mw_limebg","mw_limegroup","mw_yellow","mw_yellowbg","mw_yellowgroup","mw_amber","mw_amberbg","mw_ambergroup","mw_orange","mw_orangebg","mw_orangegroup","mw_deep_orange","mw_deep_orangebg","mw_deep_orangegroup","mw_brown","mw_brownbg","mw_browngroup","mw_gray","mw_graybg","mw_graygroup","mw_blue_gray","mw_blue_graybg","mw_blue_graygroup"].map((e,t)=>({label:(0,a.jsx)("div",{style:{background:n[e]||"#eee",width:16,height:16,borderRadius:"50%"}}),name:e,key:t}))},8823:function(e,t,r){r.d(t,{f:function(){return et},N:function(){return er}});var a=r(7437),n=r(2265),o=r(5087),l=r(970),i=r(5179),s=r(36),d=r(7827),u=r(1657);let c=n.forwardRef((e,t)=>{let{className:r,value:n,...o}=e;return(0,a.jsx)(d.fC,{ref:t,className:(0,u.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",r),...o,children:(0,a.jsx)(d.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(n||0),"%)")}})})});c.displayName=d.fC.displayName;var m=r(7014),p=r(703),f=r(3666);let g=n.memo(e=>{let{data:t}=e,[r,o]=(0,n.useState)(!1),l=(0,n.useCallback)(e=>{let{image:t,index:r}=e;return(0,a.jsx)(p.default,{width:500,height:500,alt:"image",src:(0,m.l9)(f.Z.stringifyUrl({url:"/view",query:t})),onError:()=>o(!0),unoptimized:!0},r)},[]);return!t||0===t.length||r?null:(0,a.jsx)("div",{children:t.map(l).reverse()})});var h=r(3606),w=r(6816),x=r(5849),b=r(6093),y=r(6376);function v(){let e=(0,b._)(["\n          outline: 2px solid ",";\n        "]);return v=function(){return e},e}function N(){let e=(0,b._)(["\n  min-width: 80px;\n  height: 100%;\n  min-height: 120px;\n\n  ",";\n  .react-flow__resize-control {\n    pointer-events: all !important;\n  }\n"]);return N=function(){return e},e}function j(){let e=(0,b._)(["\n  text-align: ",";\n  .react-flow__handle {\n    top: unset;\n    margin-top: 10px;\n  }\n"]);return j=function(){return e},e}y.ZP.div(N(),e=>{let{active:t,theme:r}=e;return t?(0,y.iv)(v(),r.colorPrimary):""});let _=y.ZP.div(j(),e=>{let{position:t}=e;return t}),k=e=>{var t;let{label:r,type:i,position:s,slotType:d,isRequired:c,selected:m=!1,clickable:p=!1,onClick:f}=e,g=(0,l.q)((0,o.N)(e=>e.nodes)),b=(0,n.useCallback)(e=>{if("*"===e.targetHandle||"*"===e.sourceHandle)return!0;try{var t;let r=null===(t=g.find(t=>t.id===e.target))||void 0===t?void 0:t.data.input.required[String(e.targetHandle)][0];(0,w.Z)(r)&&(r="STRING");let a=e.sourceHandle;return r===a}catch(e){return!0}},[g]),y={left:s===h.Ly.Left?"-6.5px":"auto",right:s===h.Ly.Right?"-6.5px":"auto",transform:"translate(0, -30%)"};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(_,{position:s,isRequired:c?1:0,className:(0,u.cn)("group",p&&"cursor-pointer"),onClick:f,children:[c?(0,a.jsx)(h.HH,{id:r,type:i,position:s,isValidConnection:b,style:{width:"12px",height:"12px",boxShadow:"0px 0px 12px rgba(72, 66, 66, 0.4)",borderColor:m?"white":"#a3a3a3",transitionDuration:"200ms",...y}}):null,(0,a.jsx)("a",{className:(0,u.cn)("mb-1 text-sm text-muted-foreground",p&&"group-hover:underline group-hover:text-white transition duration-200 ease-in-out"),title:Array.isArray(d)?"STRING":d,children:(0,x.Z)(null===(t=r.toLowerCase)||void 0===t?void 0:t.call(r))})]})})},F=n.memo(e=>{let{data:t,selected:r}=e;return(0,a.jsxs)(a.Fragment,{children:[t.required.map((e,t)=>{let{name:n,type:o}=e;return(0,a.jsx)(k,{slotType:o,label:n,type:"target",position:h.Ly.Left,isRequired:!0,selected:r},t)}),t.optional.map((e,t)=>{let{name:n,type:o}=e;return(0,a.jsx)(k,{slotType:o,label:n,type:"target",position:h.Ly.Left,isRequired:!0,selected:r},t)})]})}),C=n.memo(e=>{let{data:t,selected:r}=e;return(null==t?void 0:t.length)?(0,a.jsx)("div",{className:"flex-1",children:t.map((e,t)=>(0,a.jsx)(k,{slotType:e,label:e,type:"source",position:h.Ly.Right,isRequired:!0,selected:r},t))}):(0,a.jsx)("div",{})});var R=r(6969),E=r(9259);let I=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(R.fC,{ref:t,className:(0,u.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...n,children:(0,a.jsx)(R.z$,{className:(0,u.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(E.Z,{className:"h-4 w-4"})})})});I.displayName=R.fC.displayName;var L=r(4228),S=r(5509),M=r(9842);let O=n.memo(e=>{var t;let{value:r,input:s,onChange:d,name:u}=e,[c,m]=(0,n.useState)([]),{onRefresh:p,widgets:f}=(0,l.q)((0,o.N)(e=>({onRefresh:e.onRefresh,widgets:e.widgets})));return(0,n.useEffect)(()=>{var e,t,r,a,n;let{LoadImage:o}=f,l="image"===u?null==o?void 0:null===(r=o.input)||void 0===r?void 0:null===(t=r.required)||void 0===t?void 0:null===(e=t.image)||void 0===e?void 0:e[0]:null==s?void 0:s[0];m([...null!==(a=null==l?void 0:l.filter(e=>!e.includes("\\")).map(e=>({value:e,label:e})))&&void 0!==a?a:[],...Object.entries(null!==(n=null==l?void 0:l.filter(e=>e.includes("\\")).reduce((e,t)=>{let[r,a]=t.split("\\");return e[r]||(e[r]=[]),e[r].push({value:t,label:a}),e},{}))&&void 0!==n?n:{}).map(e=>{let[t,r]=e;return{label:t,options:r}})])},[s,u,f]),(0,n.useCallback)(e=>{var t;"done"===e.file.status&&p();let r=null===(t=e.file.response)||void 0===t?void 0:t.name;r&&d(r)},[d,p]),(0,a.jsxs)(a.Fragment,{children:["image"===u&&(0,a.jsxs)("div",{className:"grid w-full max-w-sm items-center gap-1.5",children:[(0,a.jsx)(M._,{htmlFor:"picture",children:"Picture"}),(0,a.jsx)(i.I,{id:"picture",type:"file"})]}),(0,a.jsxs)(S.Ph,{defaultValue:r||(null===(t=c[0])||void 0===t?void 0:t.value),onValueChange:d,children:[(0,a.jsx)(S.i4,{className:"w-full",children:(0,a.jsx)(S.ki,{placeholder:"Select"})}),(0,a.jsx)(S.Bw,{children:c.map(e=>(0,a.jsx)(S.Ql,{value:e.value,children:e.label},e.value))})]})]})}),A=n.memo(e=>{let{name:t,value:r,min:s,max:d,step:u,style:c,onChange:m}=e,p=(0,l.q)((0,o.N)(e=>e.counter)),[f,g]=(0,n.useState)(r),[h,w]=(0,n.useState)(!1),x="seed"===t,{iMax:b,iMin:y,iStep:v}=(0,n.useMemo)(()=>{let e=d,r=s,a=null!=u?u:1;switch(t){case"steps":e=200;break;case"cfg":e=32,a=.5;break;case"width":case"height":e=4096,r=512,a=4}return{iMax:e,iMin:r,iStep:a}},[t,d,s,u]),N=(0,n.useCallback)(e=>{e.stopPropagation();let t=Number(e.target.value);isNaN(t)||(g(t),m(t))},[m]);return(0,n.useCallback)(e=>{w(e.target.checked),console.log(e.target.checked)},[]),(0,n.useEffect)(()=>{x&&h&&N(Math.floor(Math.random()*b))},[p,b]),(0,a.jsx)("div",{style:c,children:(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(i.I,{type:"number",min:y,max:b,step:v,value:Number(f),onChange:e=>N(e),onBlur:e=>N(e),className:"nodrag min-w-[100px] text-muted-foreground focus:text-accent-foreground"})})})}),T=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("textarea",{className:(0,u.cn)("flex min-h-[80px] shadow-sm w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background text-muted-foreground focus:text-accent-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...n})});T.displayName="Textarea";var P=r(5754),Z=r(202);let z=n.memo(e=>{let{className:t,...r}=e,o=(0,n.useMemo)(()=>Array(30).fill(1),[]),l=(0,n.useMemo)(()=>Array(30).fill(1),[]),i=(0,n.useMemo)(()=>["--sky-300","--pink-300","--green-300","--yellow-300","--red-300","--purple-300","--blue-300","--indigo-300","--violet-300"],[]),s=()=>i[Math.floor(Math.random()*i.length)];return(0,a.jsx)("div",{style:{transform:"translate(-40%,-60%) skewX(-48deg) skewY(14deg) scale(0.675) rotate(0deg) translateZ(0)"},className:(0,u.cn)("absolute left-1/3 p-4 -top-1/4 flex  -translate-x-1/2 -translate-y-1/2 w-full h-full z-0 ",t),...r,children:o.map((e,t)=>(0,a.jsx)(Z.E.div,{className:"w-16 h-8  border-l  border-slate-700 relative",children:l.map((e,r)=>(0,a.jsx)(Z.E.div,{whileHover:{backgroundColor:"var(".concat(s(),")"),transition:{duration:0}},animate:{transition:{duration:2}},className:"w-16 h-8  border-r border-t border-slate-100 dark:border-slate-800 relative",children:r%2==0&&t%2==0?(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:"absolute h-6 w-10 -top-[14px] -left-[22px] text-slate-700 stroke-[1px] pointer-events-none",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m6-6H6"})}):null},"col"+r))},"row"+t))})});var B=r(5400),H=r(2177);let W=n.memo(e=>{let{type:t,models:r,value:o,onChange:l}=e,[i,s]=(0,n.useState)(!1);return(0,a.jsxs)(B.yo,{open:i,onOpenChange:s,children:[(0,a.jsx)(B.aM,{asChild:!0,children:(0,a.jsx)(P.z,{variant:"outline",className:"w-full",children:(0,a.jsx)("span",{className:"truncate",children:o||"Select"})})}),(0,a.jsxs)(B.ue,{className:"h-[80vh] overflow-y-auto",side:"bottom",onContextMenu:e=>e.preventDefault(),children:[(0,a.jsxs)("div",{className:"mx-auto w-full py-4 px-32",children:[(0,a.jsxs)("div",{className:"relative w-full overflow-hidden bg-background flex flex-col justify-start pt-20 pb-14",children:[(0,a.jsx)("div",{className:"absolute inset-0 w-full h-full bg-background z-20 pointer-events-none",style:{maskImage:"radial-gradient(circle at center, transparent, white 80%)"}}),(0,a.jsx)(z,{}),(0,a.jsxs)("h1",{className:"w-fit md:text-4xl text-xl font-semibold relative z-20",children:[{ckpt_name:"Checkpoint",lora_name:"Lora"}[t]," Models"]}),(0,a.jsx)("p",{className:"w-fit text-muted-foreground font-light mt-2 relative z-20 tracking-wide",children:"Select a model to use in the workflow."})]}),(0,a.jsxs)("div",{className:"w-fit md:text-4xl text-xl font-semibold absolute right-[15%] top-[20%] z-20",children:[(0,a.jsx)("input",{name:"search",type:"text",className:"px-9 flex h-6 w-full rounded-md border border-input bg-black text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",placeholder:"Search...",onKeyDown:e=>e.stopPropagation()}),(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-2   flex items-center   pointer-events-none",children:(0,a.jsx)(H._Ve,{className:"w-4 h-4 text-gray-400"})})]}),(0,a.jsx)("div",{className:"flex mb-12 w-full h-[1px] bg-gradient-to-r from-transparent via-gray-200 dark:via-gray-800 to-transparent"})]}),r.length>0&&(0,a.jsx)("div",{className:"-mt-10",children:(0,a.jsx)("div",{className:"grid grid-cols-4 gap-1 text-muted-foreground",children:r.map((e,t)=>(0,a.jsx)(P.z,{variant:"ghost",size:"sm",className:"text-xs",onClick:()=>{s(!1),l(e)},children:e.substring(0,e.indexOf("."))},t))})})]})]})}),D=n.memo(e=>{var t;let{id:r,name:s,input:d}=e,{graph:u,onPropChange:c}=(0,l.q)((0,o.N)(e=>({graph:e.graph,onPropChange:e.onPropChange}))),p=null===(t=u[r])||void 0===t?void 0:t.fields[s],f=(0,n.useMemo)(()=>(0,L.Z)(e=>{var t;c(r,s,(null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.value)?e.target.value:e)},100),[r,s,c]);return m.lj.isList(d)?"ckpt_name"===s||"lora_name"===s?(0,a.jsx)(W,{value:p,models:d.flat(),type:s,onChange:f}):(0,a.jsx)(O,{value:p,name:s,input:d,onChange:f}):m.lj.isList(d)?(0,a.jsx)(O,{value:p,name:s,input:d,onChange:f}):m.lj.isBool(d)?(0,a.jsx)(I,{value:p,defaultChecked:d[1].default,onChange:f}):m.lj.isInt(d)?(0,a.jsx)(A,{name:s.toLowerCase(),style:{width:"100%"},value:Number(null!==p?p:d[1].default),max:Number(d[1].max),min:Number(d[1].min),onChange:e=>{var t;return f(Number((null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.value)?e.target.value:e))}}):m.lj.isFloat(d)?(0,a.jsx)(A,{name:s.toLowerCase(),style:{width:"100%"},step:.01,value:Number(null!==p?p:d[1].default),max:Number(d[1].max),min:Number(d[1].min),onChange:e=>{var t;return f(Number((null==e?void 0:null===(t=e.target)||void 0===t?void 0:t.value)?e.target.value:e))}}):m.lj.isString(d)?!0===d[1].multiline?(0,a.jsx)(T,{style:{height:128,width:"100%"},defaultValue:p,onBlur:f,onKeyDown:e=>e.stopPropagation()}):(0,a.jsx)(i.I,{style:{width:"100%"},value:p,onChange:f,onKeyDown:e=>e.stopPropagation()}):null}),q=n.memo(e=>{let{data:t,selected:r,swapItem:n}=e;return(0,a.jsx)(a.Fragment,{children:t.map((e,t)=>{let{name:o,type:l,input:i}=e;return(0,a.jsx)(k,{slotType:l,label:o,type:"target",position:h.Ly.Left,isRequired:!0,selected:r,clickable:!0,onClick:()=>n({name:o,type:l,input:i})},t)})})}),V=n.memo(e=>{let{data:t,nodeId:r,selected:n,swapItem:o}=e;return(null==t?void 0:t.length)?(0,a.jsx)("div",{className:"space-y-2",children:t.map((e,t)=>{let{name:l,type:i,input:s}=e;return(0,a.jsxs)("div",{className:"text-muted-foreground focus:text-accent-foreground grid ".concat("text"===l?"grid-cols-1":"grid-cols-2"," items-center gap-2"),children:["text"!==l&&(0,a.jsx)(k,{slotType:i,label:l,type:"target",position:h.Ly.Left,isRequired:!1,selected:n,clickable:!0,onClick:()=>o({name:l,type:i,input:s})}),(0,a.jsx)(D,{name:l,id:r,input:s})]},t)})}):null});var U=r(146),G=r(3441);let J=U.fC,Y=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(U.ck,{ref:t,className:r,...n})});Y.displayName="AccordionItem";let K=n.forwardRef((e,t)=>{let{className:r,children:n,...o}=e;return(0,a.jsx)(U.h4,{className:"flex",children:(0,a.jsxs)(U.xz,{ref:t,className:(0,u.cn)("flex flex-1 items-center justify-end py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",r),...o,children:[n,(0,a.jsx)(G.Z,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})})});K.displayName=U.xz.displayName;let X=n.forwardRef((e,t)=>{let{className:r,children:n,...o}=e;return(0,a.jsx)(U.VY,{ref:t,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...o,children:(0,a.jsx)("div",{className:(0,u.cn)("pb-4 pt-0",r),children:n})})});X.displayName=U.VY.displayName;let $=n.memo(e=>{let{id:t,data:{input:r,output:i},selected:s}=e,{imagePreviews:d,inputImgPreviews:u,onUpdateNodes:c,nodes:p,graph:f}=(0,l.q)((0,o.N)(e=>{var r,a,n;return{imagePreviews:null===(n=e.graph)||void 0===n?void 0:null===(a=n[t])||void 0===a?void 0:null===(r=a.images)||void 0===r?void 0:r.map((e,t)=>({image:e,index:t})).filter(Boolean),inputImgPreviews:[{image:{filename:e.onGetNodeFieldsData(t,"image"),type:"input"},index:0}].filter(e=>e.image.filename),onUpdateNodes:e.onUpdateNodes,nodes:e.nodes,graph:e.graph}})),[h,w]=(0,n.useState)([]),x=e=>{h.find(t=>t.name===e.name)?w(t=>t.filter(t=>t.name!==e.name)):w(t=>[...t,e])},b=(0,n.useMemo)(()=>{let e=[];return Object.entries({...r.required,...r.optional}).forEach(t=>{let[r,a]=t;m.lj.isParameterOrList(a)&&!h.some(e=>e.name===r)&&e.push({name:r,type:a[0],input:a})}),e},[r,h]),y=(0,n.useMemo)(()=>{let e=e=>{let t=[];return Object.entries(null!=e?e:[]).forEach(e=>{let[r,a]=e;m.lj.isParameterOrList(a)||t.push({name:r,type:a[0]})}),t};return{required:e(r.required),optional:e(r.optional)}},[r]),{expanded:v,onExpand:N}=(0,l.q)(e=>({expanded:e.expanded,onExpand:e.onExpand})),j=v.includes(t);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-stretch justify-stretch w-full space-x-6",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)(F,{data:y,selected:s}),(0,a.jsx)(q,{data:h,selected:s,swapItem:x})]}),(0,a.jsx)(C,{data:i,selected:s})]}),b.length>0&&(0,a.jsx)(J,{type:"multiple",value:j?[t]:[],onValueChange:()=>N(t),children:(0,a.jsxs)(Y,{value:t,children:[(0,a.jsx)(K,{}),(0,a.jsx)(X,{className:"m-0.5",children:(0,a.jsx)(V,{data:b,nodeId:t,selected:s,swapItem:x})})]})}),(0,a.jsx)(g,{data:d||u})]})});var Q=r(8325),ee=r(9655);let et="sdNode",er=n.memo(e=>{var t;let r=(0,n.useRef)(null),d=(0,n.useRef)(null),[u,m]=(0,n.useState)(!1),{progressBar:p,onDuplicateNode:f,onDeleteNode:g,onModifyChange:h}=(0,l.q)((0,o.N)(t=>{var r;return{progressBar:(null===(r=t.nodeInProgress)||void 0===r?void 0:r.id)===e.id?t.nodeInProgress.progress:void 0,onDuplicateNode:t.onDuplicateNode,onDeleteNode:t.onDeleteNode,onModifyChange:t.onModifyChange}})),w=void 0!==p,x=(null===(t=e.data)||void 0===t?void 0:t.nickname)||e.data.name;e.data.name;let b=t=>{let r=t.target.value;h(e.id,"nickname",r),m(!1)},y=t=>{h(e.id,"color",t)};return(0,n.useEffect)(()=>{r.current&&(r.current.parentNode.setAttribute("type",e.data.name),r.current.setAttribute("type",e.data.name))},[e.data.name]),(0,n.useEffect)(()=>{u&&d.current&&setTimeout(()=>{var e;return null===(e=d.current)||void 0===e?void 0:e.focus()},1)},[u]),(0,a.jsxs)(ee.xV,{children:[(0,a.jsx)(ee.W4,{children:(0,a.jsx)(Q.O,{active:w,selected:e.selected,title:(0,a.jsx)(()=>(0,a.jsxs)("div",{className:"grid grid-cols-2 items-center w-full",children:[u?(0,a.jsx)(i.I,{ref:d,defaultValue:x,onKeyDown:e=>{"Backspace"===e.key&&e.stopPropagation(),["Enter","Escape"].includes(e.key)&&e.target.blur()},onBlur:b,className:"nodrag"}):(0,a.jsx)("div",{className:"w-fit ".concat(w?"animate-shimmer":""," text-xl"),onDoubleClick:()=>m(!0),children:x}),w?p>0&&(0,a.jsx)(c,{className:"absolute h-2 w-[40%] right-2 top-16 border",value:Math.floor(100*p)}):null]}),{}),node:e,children:(0,a.jsx)($,{...e})})}),(0,a.jsxs)(ee.h_,{className:"w-48",children:[(0,a.jsxs)(ee.Zo,{onClick:()=>m(!0),className:"gap-1 text-xs",children:[(0,a.jsx)(H.JtS,{}),"Rename"]},"rename"),(0,a.jsxs)(ee.qu,{children:[(0,a.jsxs)(ee.xx,{className:"gap-2 text-xs",children:[(0,a.jsx)(H.vfO,{}),"Colors"]}),(0,a.jsx)(ee.dp,{children:s.oy.map((e,t)=>(0,a.jsxs)(ee.Zo,{className:"gap-2 text-xs",onClick:()=>y(e.name),children:[e.name?e.label:"None",e.name.charAt(0).toUpperCase()+e.name.slice(1)]},t))})]},"colors"),(0,a.jsx)(ee.uP,{}),(0,a.jsxs)(ee.Zo,{onClick:()=>f(e.id),className:"gap-1 text-xs",children:[(0,a.jsx)(H.TIy,{}),"Copy"]},"copy"),(0,a.jsxs)(ee.Zo,{onClick:()=>g(e.id),className:"gap-1 text-xs",children:[(0,a.jsx)(H.XHJ,{}),"Delete"]},"delete")]})]})})},8325:function(e,t,r){r.d(t,{O:function(){return f}});var a=r(7437),n=r(2265),o=r(1657);let l=n.forwardRef((e,t)=>{let{className:r,active:n,...l}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",{"active-class":n},r),...l})});l.displayName="Card";let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...n})});i.displayName="CardHeader",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("h3",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",r),...n})}).displayName="CardTitle",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("p",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...n})}).displayName="CardDescription";let s=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",r),...n})});s.displayName="CardContent",n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r),...n})}).displayName="CardFooter";var d=r(202),u=r(3540),c=r(1774),m=r(36);let p={TOP:"radial-gradient(20.7% 50% at 50% 0%, hsl(0, 0%, 100%) 0%, rgba(255, 255, 255, 0) 100%)",LEFT:"radial-gradient(16.6% 43.1% at 0% 50%, hsl(0, 0%, 100%) 0%, rgba(255, 255, 255, 0) 100%)",BOTTOM:"radial-gradient(20.7% 50% at 50% 100%, hsl(0, 0%, 100%) 0%, rgba(255, 255, 255, 0) 100%)",RIGHT:"radial-gradient(16.2% 41.199999999999996% at 100% 50%, hsl(0, 0%, 100%) 0%, rgba(255, 255, 255, 0) 100%)"},f=n.memo(e=>{var t;let{active:r,selected:f=!1,title:g,preview:h=!1,node:w,children:x}=e,{theme:b}=(0,c.F)(),[y,v]=(0,n.useState)(!0),[N,j]=(0,n.useState)("TOP"),_=r?"shadow-lg":"",k=(null==w?void 0:null===(t=w.data)||void 0===t?void 0:t.color)||"",F="light"===b?"white":"black";return(0,a.jsxs)(l,{className:(0,o.cn)("".concat(_," ").concat(f?"border-white":""," drag-handle relative hover:shadow-lg"),"rounded-xl transition duration-200 overflow-visible min-w-[17rem]"),onMouseEnter:e=>{v(!0)},style:{background:k?"radial-gradient(circle at 0% -50%, ".concat(m.Uh[k]," 0%, ").concat(F," 50%, ").concat(F," 100%)"):F},children:[(0,a.jsxs)(i,{style:{position:"relative",padding:"1rem 1.25rem",borderTopLeftRadius:"0.75rem",borderTopRightRadius:"0.75rem",zIndex:10,transition:"all 200ms",overflow:"visible"},children:[g,!h&&(0,a.jsx)(u.KP,{position:"right",variant:"line",style:{borderWidth:"5px",borderColor:"transparent"}})]}),(0,a.jsx)(s,{style:{position:"relative",height:"100%",width:"100%",paddingTop:"1.25rem",zIndex:10,borderBottomLeftRadius:"0.75rem",borderBottomRightRadius:"0.75rem"},children:x}),r&&(0,a.jsx)(d.E.div,{className:(0,o.cn)("flex-none inset-0 overflow-hidden absolute z-0 rounded-[inherit]"),style:{filter:"blur(2px)",position:"absolute",width:"100%",height:"100%"},initial:{background:p[N]},animate:{background:y?[p[N],"radial-gradient(75% 181.15942028985506% at 50% 50%, #3275F8 0%, rgba(255, 255, 255, 0) 100%)"]:p[N]},transition:{ease:"linear",duration:1}})]})})},5754:function(e,t,r){r.d(t,{z:function(){return d}});var a=r(7437),n=r(2265),o=r(9143),l=r(7742),i=r(1657);let s=(0,l.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium active:scale-95 scale-100 transition duration-200 focus-visible:outline-none focus-visible:ring-0 focus-visible:ring-none disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10",narrow:"h-8 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:r,variant:n,size:l,asChild:d=!1,...u}=e,c=d?o.g7:"button";return(0,a.jsx)(c,{className:(0,i.cn)(s({variant:n,size:l,className:r})),ref:t,...u})});d.displayName="Button"},9655:function(e,t,r){r.d(t,{W4:function(){return c},Zo:function(){return h},dp:function(){return f},h_:function(){return g},qu:function(){return m},uP:function(){return w},xV:function(){return u},xx:function(){return p}});var a=r(7437),n=r(2265),o=r(5931),l=r(7805),i=r(9259),s=r(7501),d=r(1657);let u=o.fC,c=o.xz;o.ZA,o.Uv;let m=o.Tr;o.Ee;let p=n.forwardRef((e,t)=>{let{className:r,inset:n,children:i,...s}=e;return(0,a.jsxs)(o.fF,{ref:t,className:(0,d.cn)("flex cursor-default hover:text-muted-foreground select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",n&&"pl-8",r),...s,children:[i,(0,a.jsx)(l.Z,{className:"ml-auto h-4 w-4"})]})});p.displayName=o.fF.displayName;let f=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.tu,{ref:t,className:(0,d.cn)("z-50 min-w-[4rem] overflow-auto text-muted-foreground rounded-md border outline-none border-background bg-popover p-1 shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...n})});f.displayName=o.tu.displayName;let g=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.Uv,{children:(0,a.jsx)(o.VY,{ref:t,className:(0,d.cn)("z-50 min-w-[4rem] items-center overflow-auto text-muted-foreground rounded-md border border-background bg-popover p-1 shadow-md animate-in fade-in-80 data-[state=open]:animate-in adata-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...n})})});g.displayName=o.VY.displayName;let h=n.forwardRef((e,t)=>{let{className:r,inset:n,...l}=e;return(0,a.jsx)(o.ck,{ref:t,className:(0,d.cn)("relative flex cursor-default border border-background text-accent-foreground hover:text-muted-foreground select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n&&"pl-8",r),...l})});h.displayName=o.ck.displayName,n.forwardRef((e,t)=>{let{className:r,children:n,checked:l,...s}=e;return(0,a.jsxs)(o.oC,{ref:t,className:(0,d.cn)("relative flex text-muted-foreground hover:text-accent-foreground cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:l,...s,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(o.wU,{children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})}),n]})}).displayName=o.oC.displayName,n.forwardRef((e,t)=>{let{className:r,children:n,...l}=e;return(0,a.jsxs)(o.Rk,{ref:t,className:(0,d.cn)("relative flex text-muted-foreground hover:text-accent-foreground cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(o.wU,{children:(0,a.jsx)(s.Z,{className:"h-2 w-2 fill-current"})})}),n]})}).displayName=o.Rk.displayName,n.forwardRef((e,t)=>{let{className:r,inset:n,...l}=e;return(0,a.jsx)(o.__,{ref:t,className:(0,d.cn)("px-2 py-1.5 text-sm font-semibold text-muted-foreground hover:text-accent-foreground",n&&"pl-8",r),...l})}).displayName=o.__.displayName;let w=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",r),...n})});w.displayName=o.Z0.displayName},5179:function(e,t,r){r.d(t,{I:function(){return l}});var a=r(7437),n=r(2265),o=r(1657);let l=n.forwardRef((e,t)=>{let{className:r,type:n,...l}=e;return(0,a.jsx)("input",{type:n,className:(0,o.cn)("flex h-10 w-full shadow-sm rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...l})});l.displayName="Input"},9842:function(e,t,r){r.d(t,{_:function(){return d}});var a=r(7437),n=r(2265),o=r(4602),l=r(7742),i=r(1657);let s=(0,l.j)("text-sm text-muted-foreground font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.f,{ref:t,className:(0,i.cn)(s(),r),...n})});d.displayName=o.f.displayName},5509:function(e,t,r){r.d(t,{Bw:function(){return h},Ph:function(){return u},Ql:function(){return w},i4:function(){return p},ki:function(){return c}});var a=r(7437),n=r(2265),o=r(8178),l=r(3441),i=r(5159),s=r(9259),d=r(1657);let u=o.fC;o.ZA;let c=o.B4,m=o.JO,p=n.forwardRef((e,t)=>{let{className:r,children:n,...i}=e;return(0,a.jsxs)(o.xz,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...i,children:[n,(0,a.jsx)(m,{asChild:!0,children:(0,a.jsx)(l.Z,{className:"h-4 w-4 opacity-50"})})]})});p.displayName=o.xz.displayName;let f=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.u_,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",r),...n,children:(0,a.jsx)(i.Z,{className:"h-4 w-4"})})});f.displayName=o.u_.displayName;let g=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.$G,{ref:t,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",r),...n,children:(0,a.jsx)(l.Z,{className:"h-4 w-4"})})});g.displayName=o.$G.displayName;let h=n.forwardRef((e,t)=>{let{className:r,children:n,position:l="popper",...i}=e;return(0,a.jsx)(o.h_,{children:(0,a.jsxs)(o.VY,{ref:t,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:l,...i,children:[(0,a.jsx)(f,{}),(0,a.jsx)(o.l_,{className:(0,d.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,a.jsx)(g,{})]})})});h.displayName=o.VY.displayName,n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.__,{ref:t,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...n})}).displayName=o.__.displayName;let w=n.forwardRef((e,t)=>{let{className:r,children:n,...l}=e;return(0,a.jsxs)(o.ck,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...l,children:[(0,a.jsx)(o.eT,{children:n}),(0,a.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(o.wU,{children:(0,a.jsx)(s.Z,{className:"h-4 w-4"})})})]})});w.displayName=o.ck.displayName,n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.Z0,{ref:t,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",r),...n})}).displayName=o.Z0.displayName},5400:function(e,t,r){r.d(t,{aM:function(){return u},ue:function(){return f},yo:function(){return d}});var a=r(7437),n=r(2265),o=r(2936),l=r(7742),i=r(2235),s=r(1657);let d=o.fC,u=o.xz;o.x8;let c=o.h_,m=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.aV,{className:(0,s.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...n,ref:t})});m.displayName=o.aV.displayName;let p=(0,l.j)("fixed z-50 gap-4 bg-background p-6 shadow-xl transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-200 data-[state=open]:duration-200",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm overflow-auto",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm overflow-auto"}},defaultVariants:{side:"right"}}),f=n.forwardRef((e,t)=>{let{side:r="right",className:n,children:l,...d}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(m,{}),(0,a.jsxs)(o.VY,{ref:t,className:(0,s.cn)(p({side:r}),n),...d,children:[l,(0,a.jsxs)(o.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,a.jsx)(i.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});f.displayName=o.VY.displayName,n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.Dx,{ref:t,className:(0,s.cn)("text-lg font-semibold text-foreground",r),...n})}).displayName=o.Dx.displayName,n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,a.jsx)(o.dk,{ref:t,className:(0,s.cn)("text-sm text-muted-foreground",r),...n})}).displayName=o.dk.displayName},1657:function(e,t,r){r.d(t,{cn:function(){return o},t:function(){return l}});var a=r(3167),n=r(1367);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,a.W)(t))}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";let r=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,r)).toFixed(t<0?0:t))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}},970:function(e,t,r){r.d(t,{q:function(){return f}});var a=r(4318),n=r(2558),o=r(7014),l=r(3606),i=r(1231),s=r(7656),d=r(5249),u={Group:{input:{required:{}},output:[],output_name:[],name:"Group",category:"utils"},Reroute:{input:{required:{"*":["*"]}},output:["*"],output_name:[],name:"Reroute",category:"utils"}},c=r(9326),m=r(6288);let p=["fixed","increment","decrement","randomize"],f=(0,s.Ue)()((0,d.mW)((e,t)=>({page:"flow",counter:0,widgets:{},customWidgets:Object.keys(u),graph:{},nodes:[],edges:[],queue:[],gallery:[],edgeType:n.v[2],nodeInProgress:void 0,promptError:void 0,clientId:void 0,onSetPage:t=>{e({page:t},!1,"onSetPage")},onNewClientId:t=>{e({clientId:t},!1,"onNewClientId")},onRefresh:async()=>{let t=await (0,a.aU)();e({widgets:{...u,...t}},!1,"onRefresh")},onInit:async()=>{await (0,a.Z1)(),setInterval(()=>t().onPersistTemp(),5e3);let r=await (0,a.Gw)(),l=await (0,a.aU)();e({widgets:{...u,...l}},!1,"onInit"),t().onLoadWorkflow((0,o.Vj)());let i=n.v[parseInt(r["Comfy.LinkRenderMode"])];t().onEdgesType(i,!1)},onCreateGroup:()=>{let{nodes:r,onDetachGroup:a}=t(),n=r.filter(e=>e.selected).map(e=>a(e));if(n.length<1)return;let{left:l,right:s,top:d,bottom:c}=n.reduce((e,t)=>{let{position:{x:r,y:a},width:n,height:o}=t;return{left:Math.min(e.left,r),right:Math.max(e.right,r+Number(n)),top:Math.min(e.top,a),bottom:Math.max(e.bottom,a+Number(o))}},{left:1/0,right:0,top:1/0,bottom:0}),m={widget:u.Group,position:{x:l-40,y:d-60},width:s-l+80,height:c-d+100,key:(0,i.Z)()};e(e=>(0,o.gz)(e,m),!1,"onCreateGroup")},onSetNodesGroup:(t,r)=>{e(e=>({nodes:e.nodes.map(e=>t.includes(e.id)?e.parentNode===r.id?e:{...e,parentNode:r.id,position:{x:e.position.x-r.position.x,y:e.position.y-r.position.y}}:e.parentNode===r.id?{...e,parentNode:void 0,position:{x:e.position.x+r.position.x,y:e.position.y+r.position.y}}:e)}))},onDetachGroup:e=>{if(!e.parentNode)return e;let r=t().nodes.find(t=>t.id===e.parentNode);return{...e,parentNode:void 0,position:{x:e.position.x+Number(null==r?void 0:r.position.x),y:e.position.y+Number(null==r?void 0:r.position.y)}}},onDetachNodesGroup:(t,r)=>{e(e=>({nodes:e.nodes.map(e=>t.includes(e.id)?{...e,parentNode:void 0,position:{x:e.position.x+r.position.x,y:e.position.y+r.position.y}}:e)}))},onNodesChange:t=>{e(e=>({nodes:(0,l.Fb)(t,e.nodes)}),!1,"onNodesChange")},onUpdateNodes:(t,r)=>{e(e=>({nodes:(0,o.tV)(t,r,e.nodes)}),!1,"onUpdateNodes")},onAddNode:t=>{e(e=>(0,o.gz)(e,t),!1,"onAddNode")},onDeleteNode:r=>{let{nodes:a,onDetachNodesGroup:n}=t(),o=a.find(e=>e.id===r);n(a.filter(e=>e.parentNode===r).map(e=>e.id),o),e(e=>({nodes:(0,l.Fb)([{type:"remove",id:r}],e.nodes)}),!1,"onDeleteNode")},onDuplicateNode:t=>{e(e=>{let{graph:r,nodes:a,widgets:n}=e,l=r[t],i=a.find(e=>e.id===t),s=null==i?void 0:i.position,d=s?{...s,y:s.y+(i.height||100)+24}:void 0,u={widget:n[l.widget],node:l,position:d,...(null==i?void 0:i.width)&&{width:i.width},...(null==i?void 0:i.height)&&{height:i.height}};return(0,o.gz)(e,u)},!1,"onDuplicateNode")},onNodeInProgress:(t,r)=>{e({nodeInProgress:{id:t,progress:r}},!1,"onNodeInProgress")},onPropChange:(t,r,a)=>{e(e=>{var n;e.onUpdateNodes(t,{[r]:a});let o={...null===(n=e.graph[t])||void 0===n?void 0:n.fields,[r]:a},l={...e.graph[t],fields:o},i={...e.graph,[t]:l};return{...e,graph:i}},!1,"onPropChange")},onModifyChange:(t,r,a)=>{e(e=>({nodes:e.nodes.map(e=>e.id===t?{...e,data:{...e.data,[r]:a}}:e)}))},onGetNodeFieldsData:(e,r)=>{try{var a,n;return null===(n=t())||void 0===n?void 0:null===(a=n.graph[e])||void 0===a?void 0:a.fields[r]}catch(e){console.error(e)}},onCopyNode:()=>{let{nodes:e}=t(),r=e.filter(e=>e.selected).map(e=>e.id),a=(0,o.Mg)(t());return{data:r.reduce((t,r)=>{let n=a.data[r];if(n.parentNode){let a=e.find(e=>e.id===n.parentNode);t[r]={...n,parentNode:void 0,position:{x:n.position.x+Number(null==a?void 0:a.position.x),y:n.position.y+Number(null==a?void 0:a.position.y)}}}else t[r]=n;return t},{}),connections:a.connections.filter(e=>r.includes(e.target)&&r.includes(e.source))}},onPasteNode:(t,r)=>{let a=(0,o.ug)(Object.values(t.data).map(e=>e.position)),{data:n,idMap:l}=(0,o.Xl)(t,a,r),i=(0,o.$V)(t,l),s={data:n,...i};e(e=>Object.entries(s.data).reduce((e,t)=>{let[r,a]=t,n=e.widgets[a.value.widget];return n?(0,o.gz)(e,{widget:n,node:a.value,position:a.position,width:a.width,height:a.height,parentNode:a.parentNode,key:r}):(console.warn("Unknown widget ".concat(a.value.widget)),e)},i.connections.reduce(o.HE,e)),!0,"onPasteNode")},expanded:[],onExpand:r=>{let{expanded:a,graph:n}=t();if(r)e({expanded:a.includes(r)?a.filter(e=>e!==r):[...a,r]});else{let t=Object.keys(n);e({expanded:a.length!==t.length?t:[]})}},onEdgesChange:t=>{e(e=>({edges:(0,l.yn)(t,e.edges)}),!1,"onEdgesChange")},onEdgesAnimate:t=>{e(e=>({edges:e.edges.map(e=>({...e,animated:t}))}),!1,"onEdgesAnimate")},onUpdateFrontend:async()=>{await (0,a.wt)("Comfy.Frontend","classic"),window.location.reload()},onEdgesType:async function(t){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=t.name;e(e=>({edgeType:t,edges:e.edges.map(e=>({...e,type:o}))}),!1,"onEdgesType"),r&&await (0,a.wt)("Comfy.LinkRenderMode",n.v.indexOf(t))},onConnect:t=>{console.log("onConnect",t),e(e=>(0,o.HE)(e,t),!1,"onConnect")},onImageSave:(t,r)=>{e(e=>({gallery:e.gallery.concat(r.map(e=>({image:e}))),graph:{...e.graph,[t]:{...e.graph[t],images:r}}}),!1,"onImageSave")},onSubmit:async()=>{let r=t(),n=(0,o.Mg)(r);e({promptError:(await (0,a.u3)((0,a.Fh)({graph:n,widgets:r.widgets,customWidgets:r.customWidgets,clientId:r.clientId}))).error,counter:r.counter+1},!1,"onSubmit")},onDeleteFromQueue:async e=>{await (0,a.bu)(e),await t().onQueueUpdate()},onQueueUpdate:async()=>{},onPersistTemp:()=>{(0,o.aA)((0,o.Mg)(t()))},onSaveLocalWorkFlow:e=>{(0,o.Eo)((0,o.Mg)(t()),e)},onLoadLocalWorkflow:e=>{let r=(0,o._h)(e);r?t().onLoadWorkflow(r):t().onLoadWorkflow(c.Z)},onUpdateLocalWorkFlowGraph:e=>{(0,o.iq)(e,{graph:(0,o.Mg)(t())})},onUpdateLocalWorkFlowTitle:(e,t)=>{(0,o.iq)(e,{title:t})},onLoadWorkflow:r=>{if(console.log("[onLoadWorkflow] Received workflow:",r),!r){console.error("[onLoadWorkflow] Invalid workflow data");return}let a=r.data?r:function(e,t){console.log("inputJson.links:",e.links);let r={data:{},connections:[]},a={},n=[];return e.nodes.forEach(e=>{let o="node-".concat(e.id);a[e.id]=o;let l=t[e.type];if(l)console.log("nodeInfo:",l);else{console.log("missing node type: ",e.type),console.log(e),n.push(e.type);return}let i={widget:e.type,fields:{},modify:{}};if(e.properties&&e.properties["Node name for S&R"]&&(i.modify={nickname:e.properties["Node name for S&R"]}),l.input&&e.widgets_values){let t={...l.input.required,...l.input.optional},r=Object.keys(t),a=0,n=0;for(;a<e.widgets_values.length&&n<r.length;){let o=e.widgets_values[a];if(p.includes(o)){a++;continue}let l=r[n],s=t[l];Array.isArray(s)&&(s.length>1||1===s.length&&Array.isArray(s[0]))&&(i.fields[l]=o,a++),n++}}r.data[o]={value:i,position:{x:e.pos[0],y:e.pos[1]},width:e.size[0],height:e.size[1]},e.parentNode&&(r.data[o].parentNode="node-".concat(e.parentNode))}),Array.isArray(e.links)&&e.links.forEach(t=>{let n=t[1],o=t[3],l=a[n],i=a[o],s=e.nodes.find(e=>e.id===n),d=e.nodes.find(e=>e.id===o);if(s&&d){let e=t[2],a=s.outputs[e],n=t[4],o=d.inputs[n];if(a&&o){let e={source:l,sourceHandle:a.name,target:i,targetHandle:o.name};r.connections.push(e)}}}),n.length>0?m.Am.error("The following node types are missing:",{description:"".concat(n.join(", "))}):m.Am.success("Successfully loaded workflow."),r}(r,t().widgets);console.log("Transformed workflow:",a),e(e=>{let{widgets:t}=e,r={...e,nodes:[],edges:[],counter:0,graph:{}};return Object.entries(a.data).forEach(e=>{let[a,n]=e;if(!n.value){console.warn("[onLoadWorkflow] Node value is undefined or null for key: ".concat(a));return}let l=null==t?void 0:t[n.value.widget];l?r=(0,o.gz)(r,{widget:l,node:n.value,position:n.position,width:n.width,height:n.height,key:a,parentNode:n.parentNode}):console.warn("[onLoadWorkflow] Unknown widget: ".concat(n.value.widget))}),a.connections?a.connections.forEach(e=>{r=(0,o.HE)(r,e)}):console.warn("[onLoadWorkflow] Workflow connections is undefined or null"),r},!0,"onLoadWorkflow")},onDownloadWorkflow:()=>{(0,o.Cq)((0,o.Mg)(t()))}})))},2558:function(e,t,r){r.d(t,{v:function(){return o}});var a=r(7437),n=r(2177);let o=[{icon:(0,a.jsx)(n.FZO,{}),name:"step"},{icon:(0,a.jsx)(n.fOV,{}),name:"linear"},{icon:(0,a.jsx)(n.ecD,{}),name:"spline"}]},7014:function(e,t,r){r.d(t,{HE:function(){return o},gz:function(){return f},lj:function(){return d},W:function(){return F},$V:function(){return v},Xl:function(){return y},Sf:function(){return L},l9:function(){return T},_h:function(){return I},yY:function(){return h},rf:function(){return w},ug:function(){return x},Sk:function(){return O},qW:function(){return E},Vj:function(){return C},Eo:function(){return S},aA:function(){return R},Mg:function(){return k},iq:function(){return M},tV:function(){return g},Cq:function(){return A}});var a=r(6624),n=r(3606);let o=(e,t)=>{let{edges:r}=e,{targetHandle:a,target:o}=t;return{...e,edges:(0,n.Z_)(t,r.filter(e=>!(e.targetHandle===a&&e.target===o)))}},l=e=>e.edges.flatMap(e=>{let{source:t,sourceHandle:r,target:a,targetHandle:n}=e;return(null==r?void 0:r.length)&&(null==n?void 0:n.length)?[{source:t,sourceHandle:r,target:a,targetHandle:n}]:[]});var i=r(6816);class s{isBool(e){return!!(0,i.Z)(e)&&"BOOL"===e[0]}isInt(e){return!!(0,i.Z)(e)&&"INT"===e[0]}isFloat(e){return!!(0,i.Z)(e)&&"FLOAT"===e[0]}isString(e){return!!(0,i.Z)(e)&&"STRING"===e[0]}isList(e){return!!(0,i.Z)(e)&&Array.isArray(e[0])}isParameterOrList(e){return!!(0,i.Z)(e)&&(this.isBool(e)||this.isInt(e)||this.isFloat(e)||this.isString(e)||this.isList(e))}}let d=new s;var u=r(8823),c=r(1231);let m=e=>{let t={};return Object.entries(e.input.required).forEach(e=>{var r,a,n;let[o,l]=e;d.isBool(l)?t[o]=null!==(r=l[1].default)&&void 0!==r&&r:d.isFloat(l)?t[o]=null!==(a=l[1].default)&&void 0!==a?a:0:d.isInt(l)?t[o]=null!==(n=l[1].default)&&void 0!==n?n:0:d.isString(l)?t[o]="":d.isList(l)&&(t[o]=l[0][0])}),t},p=e=>({widget:e.name,fields:m(e)}),f=(e,t)=>{var r;let{widget:a,node:o,position:l={x:0,y:0},width:i,height:s,key:d,parentNode:m}=t,f=String(null!=d?d:(0,c.Z)()),g=e.nodes.map(e=>{var t;return null!==(t=e.zIndex)&&void 0!==t?t:0}).concat([0]).reduce((e,t)=>Math.max(e,t))+1,h={id:f,type:u.f,data:{...a,...null!==(r=null==o?void 0:o.modify)&&void 0!==r?r:{}},dragHandle:".drag-handle",position:l,zIndex:g,width:i,height:s,parentNode:m,style:{width:i,height:s}};return{...e,nodes:(0,n.Fb)([{type:"add",item:h}],e.nodes),graph:{...e.graph,[f]:null!=o?o:p(a)}}},g=(e,t,r)=>r.map(r=>(r.id===e&&(r.data={...r.data,...t}),r)),h=(e,t,r,a)=>{let n=r.current.getBoundingClientRect();return a.project({x:e-n.left,y:t-n.top})},w=(e,t)=>{let{x:r,y:a,zoom:n}=t.getViewport();return{x:Math.floor((e.current.offsetWidth/2-r)/n),y:Math.floor((e.current.offsetHeight/2-a)/n)}},x=e=>{let t=e[0];for(let r=1;r<e.length;r++){let a=e[r];(a.x<t.x||a.x===t.x&&a.y<t.y)&&(t=a)}return t},b=(e,t,r)=>({...e,position:{x:Math.floor(e.position.x-t.x+r.x),y:Math.floor(e.position.y-t.y+r.y)},key:(0,c.Z)()}),y=(e,t,r)=>Object.entries(e.data).reduce((e,a)=>{let[n,o]=a,l=b(o,t,r);return{data:{...e.data,[l.key]:l},idMap:{...e.idMap,[n]:l.key}}},{data:{},idMap:{}}),v=(e,t)=>({connections:e.connections.map(e=>({...e,source:t[e.source],target:t[e.target]}))});var N=r(9326);let j="civitui-flow-temp",_="civitui-flow-local",k=e=>{let t={};return e.nodes.forEach(r=>{let a=e.graph[r.id];void 0!==a&&(t[r.id]={value:a,position:r.position},r.width&&(t[r.id].width=r.width),r.height&&(t[r.id].height=r.height),r.parentNode&&(t[r.id].parentNode=r.parentNode))}),{data:t,connections:l(e)}},F=()=>{try{localStorage.removeItem(j)}catch(e){console.log("[cleanTempWorkflow]",e)}},C=()=>{let e=localStorage.getItem(j);return e===JSON.stringify({data:{},connections:[]})&&(localStorage.removeItem(j),e=null),e?JSON.parse(e):N.Z},R=e=>{try{localStorage.setItem(j,JSON.stringify(e))}catch(e){console.log("[saveTempWorkflow]",e)}},E=()=>{try{let e=localStorage.getItem(_);return e?JSON.parse(e):[]}catch(e){return console.log("[retrieveLocalWorkflows]",e),[]}},I=e=>{let t=E().find(t=>t.id===e);return t?t.graph:null},L=e=>{try{let t=E().map(t=>t.id!==e&&t).filter(Boolean);localStorage.setItem(_,JSON.stringify(t))}catch(e){console.log("[deleteLocalWorkflowFromId]",e)}},S=(e,t)=>{try{let r=E(),a=new Date().getTime();r.push({title:t||"Local-".concat(a),time:a,id:"comfyui-".concat(a,"-").concat(Math.floor(1e6*Math.random())),graph:e}),localStorage.setItem(_,JSON.stringify(r))}catch(e){console.log("[saveLocalWorkflow]",e)}},M=(e,t)=>{try{let r=E().map(r=>r.id!==e?r:{...r,...t,time:new Date().getTime()});localStorage.setItem(_,JSON.stringify(r))}catch(e){console.log("[updateLocalWorkflow]",e)}},O=(e,t)=>{try{let r=new FileReader;e&&(console.log("[readWorkflowFromFile] Reading workflow file:",e.name),r.readAsText(e),r.addEventListener("load",e=>{var r;let a=null===(r=e.target)||void 0===r?void 0:r.result;if("string"==typeof a)try{console.log("[readWorkflowFromFile] File content:",a);let e=JSON.parse(a);console.log("[readWorkflowFromFile] Parsed workflow:",JSON.stringify(e,null,2));try{t(e)}catch(e){console.error("[readWorkflowFromFile] Error in callback:",e)}}catch(e){console.error("[readWorkflowFromFile] Error parsing workflow JSON:",e)}else console.warn("[readWorkflowFromFile] File content is not a string")}))}catch(e){console.log("[readWorkflowFromFile]",e)}},A=(e,t)=>{let r=new Blob([JSON.stringify(e)],{type:"application/json"}),a=URL.createObjectURL(r),n=document.createElement("a");n.download=t?"".concat(t,".json"):"workflow.json",n.href=a,n.click(),URL.revokeObjectURL(a)};r(4318);let T=e=>"".concat(a.Z.protocol,"//").concat(a.Z.host).concat(e)}}]);